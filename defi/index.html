

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/touxiang.png">
  <link rel="icon" href="/img/touxiang.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Naveen">
  <meta name="keywords" content="">
  
    <meta name="description" content="DeFi 项目分享 概念梳理 DeFi 定义  和 CeFi 的对比:     CeFi DeFi     需要被许可:封闭系统,建立在中心化的数据库上;使用和建立需要第三方的批准和同意 无需许可:开源系统;建立在无许可的区块链之上;任何人都可以使用、交互操作或在其上构建,无须第三方批准和协议   托管:资产由持有执照的第三方保管 无托管:资产不由单独第三方保管   中心化治理:单一实体负责升级决">
<meta property="og:type" content="article">
<meta property="og:title" content="DeFi 项目分享">
<meta property="og:url" content="http://navafee.github.io./defi/index.html">
<meta property="og:site_name" content="Naveen&#39;s Blog">
<meta property="og:description" content="DeFi 项目分享 概念梳理 DeFi 定义  和 CeFi 的对比:     CeFi DeFi     需要被许可:封闭系统,建立在中心化的数据库上;使用和建立需要第三方的批准和同意 无需许可:开源系统;建立在无许可的区块链之上;任何人都可以使用、交互操作或在其上构建,无须第三方批准和协议   托管:资产由持有执照的第三方保管 无托管:资产不由单独第三方保管   中心化治理:单一实体负责升级决">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://navafee.github.io./img/defi/image.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-1.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-2.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-3.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-4.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-5.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-7.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-8.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-9.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-10.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-11.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-12.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-13.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-14.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-15.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-16.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-17.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-18.png">
<meta property="og:image" content="http://navafee.github.io./img/defi/image-19.png">
<meta property="article:published_time" content="2023-03-12T03:16:33.000Z">
<meta property="article:modified_time" content="2024-10-12T03:49:13.350Z">
<meta property="article:author" content="Naveen">
<meta property="article:tag" content="Web3">
<meta property="article:tag" content="DeFi">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://navafee.github.io./img/defi/image.png">
  
  
  
  <title>DeFi 项目分享 - Naveen&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"navafee.github.io.","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"e345a937271eff2c296fd61722e26396","google":{"measurement_id":"G-R246FK9TNM"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"mEN8CgTmhUaBxq7znUAPTFGF-gzGzoHsz","app_key":"KCyhOEOuPNXKuepvfXeG8zG3","server_url":"https://navafee.github.io/","path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?e345a937271eff2c296fd61722e26396";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-R246FK9TNM", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'G-R246FK9TNM');
        });
      }
    </script>
  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Naveen</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="DeFi 项目分享"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-12 11:16" pubdate>
          2023年3月12日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          33 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">DeFi 项目分享</h1>
            
            
              <div class="markdown-body">
                
                <h1>DeFi 项目分享</h1>
<h2 id="概念梳理">概念梳理</h2>
<h3 id="DeFi-定义">DeFi 定义</h3>
<p><img src="../img/defi/image.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>和 CeFi 的对比:<br>
<img src="../img/defi/image-1.png" srcset="/img/loading.gif" lazyload alt=""></p>
<table>
<thead>
<tr>
<th>CeFi</th>
<th>DeFi</th>
</tr>
</thead>
<tbody>
<tr>
<td>需要被许可:封闭系统,建立在中心化的数据库上;使用和建立需要第三方的批准和同意</td>
<td>无需许可:开源系统;建立在无许可的区块链之上;任何人都可以使用、交互操作或在其上构建,无须第三方批准和协议</td>
</tr>
<tr>
<td>托管:资产由持有执照的第三方保管</td>
<td>无托管:资产不由单独第三方保管</td>
</tr>
<tr>
<td>中心化治理:单一实体负责升级决策和管理员权限</td>
<td>去中心化的信任和治理:DAO;持有治理代币即可投票</td>
</tr>
<tr>
<td>真实身份:遵守 KYC/AML,需使用真实身份信息注册</td>
<td>匿名性隐私性:不用提供真实身份,无 KYC/AML</td>
</tr>
</tbody>
</table>
<h3 id="DeFi-去中心化智能合约平台实现的架构">DeFi 去中心化智能合约平台实现的架构</h3>
<p><img src="../img/defi/image-2.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="名词解释">名词解释</h3>
<ul>
<li>
<p><strong>EVM(以太坊虚拟机)</strong>:以太坊不是分布式账本,而是分布式状态机器。以太坊的状态是一个大型数据结构,它不仅保存所有帐戶和余额,而且还保存一个机器状态,它可以根据预定义的一组规则在不同的区块之间进行更改,并且可以执行任意的机器代码。在区块中更改状态的具体规则由 EVM 定义。</p>
</li>
<li>
<p><strong>协议 Protocol</strong>: 不同策略的 DeFi 项目</p>
</li>
<li>
<p><strong>智能合约 Contract</strong>: 一个由程序控制的链上账戶 <a target="_blank" rel="noopener" href="https://etherscan.io/tx/0x16fce0a64b5d348251ff578d945195c82ba3ec7bcd92fdd6a6222af87755b11d;%E4%BB%8E%E7%BC%96%E7%A8%8B%E2%BB%86%E5%BA%A6%E7%9C%8B,%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E6%98%AF%E5%9C%A8%E5%8C%BA%E5%9D%97%E9%93%BE%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F,%E9%80%9A%E8%BF%87%E5%AF%B9%E8%BE%93%E5%85%A5%E6%95%B0%E5%80%BC%E7%9A%84%E5%87%BD%E6%95%B0%E8%BF%90%E7%AE%97%E5%92%8C%E5%AD%98%E5%82%A8,%E8%BF%94%E5%9B%9E%E8%BE%93%E5%87%BA%E6%95%B0%E6%8D%AE">https://etherscan.io/tx/0x16fce0a64b5d348251ff578d945195c82ba3ec7bcd92fdd6a6222af87755b11d;从编程⻆度看,智能合约是在区块链上运行的应用程序,通过对输入数值的函数运算和存储,返回输出数据</a>;</p>
</li>
<li>
<p><strong>原生代币</strong>: 链上最基础的资产,会用于支付网络费用。如 Bitcoin 的基础代币是 BTC、Ethereum 的基础代币是 ETH、BSC 是 BNB、Solana 是 SOL。</p>
</li>
<li>
<p><strong>非原生代币</strong>: 包含同质化代币 ERC20、非同质化代币 ERC721、多代币 ERC1155 等</p>
</li>
<li>
<p><strong>TVL</strong>: Total Value Locked(总锁定价值),它泛指一个 DeFi 平台中用戶所抵押、被锁定的数字资产价值,通常用作衡量 defi 协议体量和活跃度的指标。</p>
</li>
<li>
<p><strong>预言机(Oracle)</strong>: 区块链外信息写入区块链内的机制。预言机的功能就是将外界信息写入到区块链内,完成区块链与现实世界的数据互通。它允许确定的智能合约对不确定的外部世界作出反应,是智能合约与外部进行数据交互的唯一途径,也是区块链与现实世界进行数据交互的接口。大家会很形象的把公链比作操作系统,DAPP 类比的话就是 APP,那么预言机可以形象的比做 API 接口(API 是一组定义、程序及协议的集合,通过 API 接口实现计算机软件之间的相互通信)。这个类比虽然不准确,而预言机正是扮演这样的⻆色,预言机是区块链和现实世界之间的纽带,可以实现数据互通的工具。</p>
</li>
</ul>
<h2 id="UNISWAP">UNISWAP</h2>
<p><a target="_blank" rel="noopener" href="https://uniswap.org/">https://uniswap.org/</a></p>
<h3 id="开创-AMM-机制">开创 AMM 机制</h3>
<p>Automated Market Maker,流动性池算法</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=1PbZMudPP5E">https://www.youtube.com/watch?v=1PbZMudPP5E</a></p>
<p><img src="../img/defi/image-3.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>即时流动性,无论交易规模如何</p>
<ul>
<li>购买资产 X 会提高 X 的价格和降低 Y 的价格</li>
<li>X 和 Y 的资产量决定了价格</li>
</ul>
<p><img src="../img/defi/image-4.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>优缺点:</p>
<ul>
<li>无订单簿维护:但需要套利</li>
<li>CPAMM 的简单实现:较低的 gas 费</li>
<li>无偿损失/币价脱钩的危险:资金可能全部流失</li>
<li>低流动性市场的高滑点:需设置 slippage tolerance</li>
<li>用戶易受三明治攻击</li>
<li>需要维持这个 swap 池,就需要有人提供流动性</li>
</ul>
<h3 id="流动性挖矿">流动性挖矿</h3>
<p><img src="../img/defi/image-5.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>Vampire Attack by SushiSwap<br>
<a target="_blank" rel="noopener" href="https://sushi.com/">https://sushi.com/</a><br>
开创了 LP Rewards</p>
<p>Uniswap V3 核心升级<br>
<a target="_blank" rel="noopener" href="https://liaoph.com/uniswap-v3-1/">https://liaoph.com/uniswap-v3-1/</a></p>
<p><img src="../img/defi/image-7.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>1、swap 账戶里选择 token 进行兑换:复制钱包里代币对应的合约地址,输入到选择代币界面,系统会自动匹配到对应合约</p>
<ol>
<li>
<p>稳定币兑换其他</p>
<ul>
<li>Balance of DAI roundown(含对应 USD 价值)</li>
<li>Balance of ETH(含对应 USD 价值)</li>
<li>1ETH=3670DAI</li>
</ul>
</li>
<li>
<p>需要上链的币</p>
<ul>
<li>Balance of Token1</li>
<li>Balance of Token2</li>
<li>请求授权时会显示交易费?</li>
<li>执行价格和现货价差<br>
<img src="../img/defi/image-8.png" srcset="/img/loading.gif" lazyload alt=""><br>
<img src="../img/defi/image-9.png" srcset="/img/loading.gif" lazyload alt=""></li>
</ul>
<p>(V2 会显示 LP 费用、路径、执行价格和现货价差;</p>
<ul>
<li>要给 uniswap 授权⸺钱包上签名</li>
<li>设置滑点容忍度</li>
<li>点击 SWAP ANYWAY</li>
<li>弹出默认 gas 费,可调到更高(包含燃料价格 GWEI 和燃料限制)</li>
</ul>
</li>
</ol>
<p>2、上链!</p>
<p>链上查看兑换结果:<br>
<img src="../img/defi/image-10.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ADD LIQUIDIDTY</p>
<ol>
<li>选币对</li>
<li>选手续费率</li>
<li>设置价格区间 Pmin,Pmax;输入值会自动根据 tick 调整,可选择增加或减少双边手续费(例如选 0.3%,增减手续费的变动单位即为 0.6%)</li>
<li>放入等额的两种币,满足更少的量</li>
<li>确认授权,签名</li>
</ol>
<p>可以赚到 0.3%的手续费</p>
<p>上链,转入钱包对应的 NFTtoken</p>
<p>此时流动性产生,可在 pool 中看到对应的仓位钱包里出现 ERC721 token</p>
<p><img src="../img/defi/image-11.png" srcset="/img/loading.gif" lazyload alt=""><br>
<img src="../img/defi/image-12.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>V2 迁移 V3<br>
<img src="../img/defi/image-13.png" srcset="/img/loading.gif" lazyload alt=""><br>
仍需选 fee tier 和创建 price range<br>
授权迁移签名<br>
gas 费<br>
<img src="../img/defi/image-14.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h2 id="CURVE">CURVE</h2>
<p><a target="_blank" rel="noopener" href="https://curve.fi/">https://curve.fi/</a></p>
<p>造血器+发动机</p>
<p>一种基于 AMM 的稳定币兑换协议,最开始他们自称稳定 swap<br>
允许交易者把 USDC swap 为 DAI 或者其他代币,低滑点+低手续费<br>
随着时间推移以及越来越多人加入,curve 开始增加其他的代币如 ETH 和 BTC 和其他另类资产</p>
<h3 id="一、AMM-机制">一、AMM 机制</h3>
<p>恒定乘积+恒定总和</p>
<p>x*y=k1<br>
x+y=k2</p>
<p>价格均衡点附近使用恒定总和保证稳定币兑换深度;<br>
偏离均衡点较多时使用恒定乘积避免流动性被价格过大波动抽干<br>
<img src="../img/defi/image-15.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="二、主营业务">二、主营业务</h3>
<ol>
<li>
<p>稳定币/其他资产兑换</p>
<p>低兑换费用、低滑点、深度好<br>
初期使用代币进行补贴,维持稳定币的流动性</p>
<ol>
<li>
<p>稳定币兑换<br>
支持 DAI、USDC、USDT 等 20 多种稳定币的兑换</p>
</li>
<li>
<p>映射资产兑换<br>
类似 tbtc、wbtc、rbtc、seth 等映射资产之间的兑换,保证了映射资产的流动性和价格稳定</p>
</li>
<li>
<p>票据类资产兑换<br>
Defi 协议的票据,用来赎回用戶的本金<br>
e.g. Compound 池里的 cDAI\cUSDC、Y(Yearn)池里的 yDAI\yUSDC\yUSDT\yTUSD,MIM 池里的 MIM</p>
</li>
</ol>
</li>
<li>
<p>流动性挖矿</p>
<ol>
<li>
<p>步骤:</p>
<ol>
<li>在 Curve Pools 里选择一个流动性池,自定义存入流动池的稳定币数量;</li>
<li>查看到稳定币存入流动性池后得到的 LP 代币数量和单价,以及预计的矿工费;</li>
<li>交易发出后可以在 ETH 历史交易界面看到两笔等待打包的交易:授权交易和稳定币 DAI 兑换为 LP 代币的交易;两笔交易成功后即可在资产界面查看收到的 LP 代币。</li>
<li>将 LP 代币质押到 Curve Dao 就可以获得 CRV 代币。</li>
</ol>
</li>
<li>
<p>收益来源:</p>
<ol>
<li>平台 swap 交易手续费:取决于 curve 的 pool 里有多少代币、有多少人在交易以及收费标准</li>
<li>LP 挖矿获得的 CRV 代币:<br>
持有者可以将 CRV 锁仓到 Curve 协议获取 veCRV 来享受代币的治理功能和协议奖励<br>
A. 用戶可以凭借质押的 veCRV 的数量获得全平台大部分交易池的手续费分成,比率 50%(另外 50%给流动性提供者);<br>
B. 锁定 CRV 之后,可以通过 Boost 功能来提高做市所获得的 CRV 奖励收益<br>
C. 协议治理</li>
<li>个别项目方如 Synthetix 和 Ren 还会提供自家代币用来激励流动性挖矿的用戶</li>
</ol>
</li>
<li>
<p>矿池种类:</p>
<ol>
<li>稳定币矿池:base apy 来自于手续费收益,rewards apy 来自于 LP 挖矿;</li>
<li>第三方协议矿池:yfi、compound 等。base apy 来自于第一部分手续费收益+第三方协议的存款利息,rewards apy 来自于 LP 挖矿。</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="三、⻚面操作流程">三、⻚面操作流程</h3>
<p>包含绑定钱包、兑换、挖矿等详细操作步骤</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/182878770">https://zhuanlan.zhihu.com/p/182878770</a></p>
<h2 id="Convex">Convex</h2>
<p><a target="_blank" rel="noopener" href="https://www.convexfinance.com/stake">https://www.convexfinance.com/stake</a></p>
<p>服务于 Curve 的理财协议</p>
<p>本质是一个收益聚合器,通过聚集市场上提供 LP 用戶和持有 $CRV 用戶的资金,让双方都可以获益</p>
<h3 id="产品机制">产品机制</h3>
<ol>
<li>
<p>CRV 质押用戶</p>
<ol>
<li>质押 CRV:用戶把 CRV 质押到 Convex 协议,永久锁定为 veCRV,同时获得 cvxCRV;cvxCRV 不可赎回,但可通过 Curve 上的 cvxcrv 池子 把 cvxCRV 换成 CRV</li>
<li>质押 cvxCRV:<br>
用戶把 cvxCRV 质押后可以享受权益,随时都能取回</li>
<li>用戶可以获得:
<ul>
<li>50%的交易手续费($3CRV);</li>
<li>Convex 原生通证 $CVX 奖励;</li>
<li>CRV LP 挖矿奖励的 10%;</li>
<li>Curve 提供的空投奖励<br>
<img src="../img/defi/image-16.png" srcset="/img/loading.gif" lazyload alt=""></li>
</ul>
</li>
</ol>
</li>
<li>
<p>提供 LP 的用戶</p>
<ol>
<li>用戶可以把 LP 存到 Convex 协议,随时都能赎回</li>
<li>用戶可以获得:
<ul>
<li>50%的交易手续费($3CRV);</li>
<li>Convex 原生通证 $CVX 奖励;</li>
<li>CRV LP 挖矿奖励的 90%,以及 veCRV 用戶才能得到的挖矿加速奖励;</li>
<li>其他流动性挖矿奖励(SNX、PNT、BOR、LDO 等)</li>
</ul>
</li>
</ol>
</li>
<li>
<p>CVX 质押用戶<br>
在 Curve cvxcrv pool 中存入流动性,然后质押你的 cvxcrvCRV token 来赚取 CVX</p>
</li>
</ol>
<p>提供 LP 的用戶可以获得挖矿加速奖励,Convex 会收取其中 17% 的费用,其中:</p>
<ul>
<li>10% 以 CRV 的形式分配给 cvxCRV 质押者;</li>
<li>5% 以 cvxCRV 的形式分配给 CVX 质押者;</li>
<li>1% 以 CRV 的形式分配给 harvest 函数调用者(偿还调用合约函数的 gas)</li>
</ul>
<p><img src="../img/defi/image-17.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="稳定币项目的流动性租赁战争">稳定币项目的流动性租赁战争</h3>
<p>Convex 是 Curve 流动性战争的真正推手,将 Curve war 彻底的白热化:</p>
<ol>
<li>
<p>Convex 通过将 CRV 永久转换成 cvxCRV,分离了 veCRV 的投票权和收益权。<br>
CRV 通过 cvxCRV 变成了是一张可转让的永恒债券。相对之前,可以在不用锁仓的情况下,赚取原来 veCRV 的大部分收益(Convex 扣除 10%的 CRV 收益)同时还赚取 CVX;而 veCRV 的投票权转让交给了 vlCVX⸺锁定的 CVX。</p>
</li>
<li>
<p>CVX 投票权代理,CVX 的⻓期持仓用戶可以通过锁定的 CVX 16 周进行投票,也可以并且把投票权进行转让给特定的地址,使得贿赂选票机制更加容易执行。</p>
</li>
<li>
<p>CVX 的 mint 的曲线是会根据 CRV 收益 claim 之后逐步减少,意味着 CVX 是随着 CRV 的增多的情况逐步通缩的,这意味着在保持住 crv 持续被吸收的情况下,越往后单个锁住的 CVX 能够控制的 veCRV 投票权会越来越多,间接代表了一个 CVX 的基础价值。</p>
</li>
</ol>
<h2 id="AAVE">AAVE</h2>
<p><a target="_blank" rel="noopener" href="https://aave.com/">https://aave.com/</a></p>
<p>去中心化借贷协议,支持 20 种加密货币+7 条公链</p>
<p>芬兰语&quot;幽灵&quot;, 2017 年叫 ETHLend,采用点对点借贷模式,匹配效率低下;<br>
2020 年 Aave 改进了模型,把需要借方等待贷方的传统 Peer to Peer 转换为 Peer to Smart Contract,大幅扩大规模。</p>
<h3 id="借贷池">借贷池</h3>
<p>以资金池的方式聚合资金后将其出借给借方,通过算法平衡供求设定 APY;出借币种涵盖大部分主流币;</p>
<p>AAVE 通过本息额等量凭证代币方案,增加凭证代币数量来支付利息</p>
<h3 id="超额抵押-Overcollateralized-Loans">超额抵押 Overcollateralized Loans</h3>
<p>你必须存入 100$ETH 作为抵押,才能借出 80USDC</p>
<h3 id="⻛控模型">⻛控模型</h3>
<p><img src="../img/defi/image-18.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>应用场景:Leveraged Lending</p>
<p>你在 AAVE 用 100$ETH质押,换了80USDC<br>
去Uniswap用80USDC换了80$ETH 再反手把这 80$ETH质押,换了64USDC<br>
再去Uniswap换64$ETH 质押进 AAVE</p>
<p>你现在有了 100+80+64=244$ETH,如果 ETH 涨了 10%,你就能赚 24.4,相当于盈利 24.4%;<br>
跌了就直接强平</p>
<h3 id="还款">还款</h3>
<p>比如你现在有了 100%+的 loan,你只需要登录 AAVE 然后还贷款+一点点 aave 代币</p>
<p>AAVE 不会像传统借贷那样要求你在固定日期还款,只要你的质押头寸 safe 就可以一直借着,但代付利息会随时间推移越来越高,而且你的质押品也会越来越可能被强平</p>
<h3 id="闪电贷-Flash-Loans">闪电贷 Flash Loans</h3>
<p>不用付任何抵押品就能火速借到巨额资金,但必须迅速还回这笔钱</p>
<p>套利空间:你用 1$在币安买入,1.01$在 Coinbase 卖出</p>
<p>以太坊区块链上基本 13 秒内能实现</p>
<h2 id="Compound">Compound</h2>
<ol>
<li>
<p>Supplying Assets</p>
<p>存入对应 market 的资产被表示为对应的 ERC-20 token balance (“cToken”), 当该币种 market 由于借贷需求积攒利息,cToken 可以转为标的资产的增量。持有 ERC-20 cToken 可以赚钱,类似银行存款赚利息。</p>
</li>
<li>
<p>Borrowing Assets</p>
<p>2.1 Collateral Value:</p>
<p>存入协议的资产(以 cToken 所有权表示)</p>
<p>Collateral factor:∈[0,90%],每个币种不一样,流动性越强 collatral factor 越高;collatral factor 为 0 的币种不能作为抵押</p>
<p>Borrowing Capacity=∑(Supply i*Collateral Factor i)</p>
<p>用戶不能借超过 capacity 的 asset,账戶不能借出、转账或赎回 cToken 抵押品,因为会使贷款总价值超出贷款能力</p>
<p>2.2 Risk&amp;Liquidation</p>
<p>Liquidation Discount:当前 borrows 价值超过 Borrowing Capacity 时,超出的部分需充入 cToken collateral,但价值可以用当前市场价减去 Liquidation Discount,激励套利者进入,减少借贷者的⻛险敞口</p>
<p>Close factor:符合平仓条件的比例,是借入资产中可以偿还的部分,范围从 0 到 1。清算过程可以继续被调用,直到用戶的借款小于他们的借款能力。</p>
<p>Liquidation:Borrowing balance 超过 total collateral value(LTV&gt;1)时强平</p>
<p>任何拥有 borrowed asset 的以太坊地址都可以调用清算功能,用他们的资产交换借款人的 cToken 抵押品。借贷双方用戶、资产和价格都包含在 Compound 协议中,清算是无摩擦的。</p>
<p>2.3 利率模型</p>
<p>Utilization ratio U:在单一变量中统一市场 a 的供需关系</p>
<p>Ua = Borrows a / (Cash a + Borrows a)</p>
<p>比如贷款利率 a 可以表示为:Borrowing Interest Rate a = 2.5% + Ua * 20%</p>
</li>
<li>
<p>Implementation</p>
<p>一个 Compound money market 本质是一种允许以太坊地址 supply 和 borrow 资产并计息的明细账本</p>
<p>3.1 cToken 合约</p>
<p>Supply assets→mint(uint amount underlying) cTokens,可以赎回(uint amount)cToken;</p>
<p>cToken 对标的资产的价格(兑换比率)会持续增⻓,因为总 borrowing balance 会因为应计利息而持续增⻓:</p>
<p><img src="../img/defi/image-19.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>3.2 利率机制</p>
<p>Interest Rate Index:所有借款用戶统一利率标准,利率会随着市场供需变化而调整;每个币种利率由于用戶铸币、赎回、借款、偿付和清算资产导致的利率历史变更会被抓取形成 Interest Rate Index.</p>
<p>每次交易发生时,资产的利率指数都会更新,以使用该期间的利息(以 r * t 表示,使用 per-block 利率计算)计算自上次指数以来的复利:</p>
<p>更新 total Borrow Balance 包括自上一个指数以来的应计利息:并且应计利息的一部分被保留(留出)作为储备,由 reserve factor 确定,范围从 0 到 1:</p>
<p>3.3 Borrowing</p>
<p>调用 borrow 功能需检查用戶账戶净值,在抵押品充足时会更新用戶的 borrow balance,把 token 转入用戶以太坊地址并更新对应市场浮动利率。</p>
<p>Borrows 应计利息计算方式和 3.2 中完全一致,借款人有权在任何时候通过调用 repayBorrow(单位金额)偿还未偿贷款</p>
<p>3.4 Liquidation</p>
<p>如果由于抵押品的价值下降，或者借入的资产价值增加，用户的 borrow balance 超过其总抵押品价值(Borrowing Capacity)，则可以调用公共函数清算(address target，address collateralAsset，address borrowAsset，uint closeAmount)，该函数将调用用户的资产交换为借款者的抵押品，比市场价格略高。</p>
<p>3.5 Price Feeds</p>
<p>Price Oracle：维护每个受支持资产的当前汇率；compound 协议将设定资产价值的能力委托给一个委员会，该委员会汇总前 10 家交易所的价格。这些汇率用于确定借款能力和抵押要求，以及所有需要计算账户等值的功能。</p>
<p>3.6 Comptroller</p>
<p>Compound protocol 不支持一些 token，协议承认的 markets 必须被 whitelistedl，通过一个管理函数 supportMarket(address market, address interest rate model)实现，它允许用户开始与资产进行交互。为了借入资产，必须有来自 Price Oracle 的有效价格；为了将资产用作抵押品，必须有一个有效的价格和一个 collateral factor。 每个函数调用都通过一个名为 Comptroller 的策略层进行验证，在允许用户操作继续之前验证担保品和流动性。</p>
</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Web3/" class="category-chain-item">Web3</a>
  
  
    <span>></span>
    
  <a href="/categories/Web3/DeFi/" class="category-chain-item">DeFi</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Web3/" class="print-no-link">#Web3</a>
      
        <a href="/tags/DeFi/" class="print-no-link">#DeFi</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>DeFi 项目分享</div>
      <div>http://navafee.github.io./defi/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Naveen</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年3月12日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/go-practice/" title="Golang 代码规范">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Golang 代码规范</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/uniswapv3/" title="Uniswap V3 深度解析">
                        <span class="hidden-mobile">Uniswap V3 深度解析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
